<?php
session_start();
///////////////////////////////////////////////////////////////////////////////////////////////////////
//Connection à la base de données
///////////////////////////////////////////////////////////////////////////////////////////////////////
try
{
  $bdd = new PDO(
    'mysql:host=localhost;dbname=db_site;charset=utf8',
    'root',
    '',
    array(PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION));
}
catch (Exception $e)
{
  die('Erreur : ' . $e->getMessage());
}

///////////////////////////////////////////////////////////////////////////////////////////////////////
//variable de redirection si un des champs est faux
///////////////////////////////////////////////////////////////////////////////////////////////////////
$redirect = false;
if($redirect){
  header('Location: admin_create_compteur.php');
}
else{

///////////////////////////////////////////////////////////////////////////////////////////////////////
//insertion en base
///////////////////////////////////////////////////////////////////////////////////////////////////////
  $req = $bdd->prepare(
    'INSERT INTO compteurs (compteur_number,id_user_assign)'.
    'VALUES (:compteur_number, :id_user_assign)'
    );

  $req->execute(array(
    'compteur_number' => htmlspecialchars($_POST['num_compteur']),
    'id_user_assign' => htmlspecialchars($_POST['name'])
  	));

}
header('Location: admin_managment_compteur.php');
?>
